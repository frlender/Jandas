"use strict";var jandas=(()=>{var k=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var S=k(o=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.range=o.check=o._trans_iloc=o.isStrArr=o.isNumArr=o.isVal=o.isArr=o.isStr=o.isNum=void 0;var f=function(e){return typeof e=="number"};o.isNum=f;var p=function(e){return typeof e=="string"};o.isStr=p;var l=function(e){return Array.isArray(e)};o.isArr=l;var E=function(e){return f(e)||p(e)};o.isVal=E;var A=function(e){return l(e)&&e.length>0&&f(e[0])};o.isNumArr=A;var V=function(e){return l(e)&&e.length>0&&p(e[0])};o.isStrArr=V;var m={index:{set:function(e,t,n){var i="the values property of index";if(!Number.isInteger(e))throw"key for ".concat(i," must be a integer. But ").concat(e," is found.");if(e<0||e>t)throw"key for ".concat(i," must be in the range of [0,").concat(t,"] inclusively.");if(!f(n)&&!p(n))throw"value for ".concat(i," must be a number or a string.")}},frame:{index:{set:function(e,t){if(e!==t)throw"Index shape is not equal to shape of Series or axis of DataFrame."}},b:{expr:function(e){if(e%2!==0)throw"` is not paired in the expression."}}},iloc:{num:function(e,t){if(!Number.isInteger(e))throw"input number index must be integer.";if(e<0||e>=t)throw"input number index out of range."},bool:function(e,t){if(e.length!==t)throw"boolean[] index shape does not match the shape of indexed vector."},str:{colon:function(e){if(!e.includes(":"))throw'no ":" is found in string range index.';if(e.split(":").length>2)throw'currently only one ":" should be in the string index'},parsed:function(e,t){if(Number.isNaN(e)||Number.isNaN(t))throw"string range index format is not correct.";if(!Number.isInteger(e)||!Number.isInteger(t))throw"numbers in string range index must be integers."}}},iset:{rpl:{val:function(e){if(l(e))throw"the replacement should be a value not an array"},num:function(e,t){var n=l(e);if(!n||e.length!==t)throw"the length of replacement values (".concat(n?e.length:e,") ")+"does not match the length (".concat(t,") of number[] index.")},mat:function(e,t){if(e.length!==t[0])throw"the first dimension of replacement values (".concat(e.length,")")+" does not match the data frame shape ".concat(t);var n=e.reduce(function(i,r){return i&&r.length===t[1]},!0);if(!n)throw"the second dimension of replacement values"+" does not match the data frame shape ".concat(t)},bool:function(e,t){var n=t.reduce(function(i,r){return r?i+1:i},0);if(e.length!==n)throw"the length of replacement values does not match the number of true values in boolean[] index"}}},set:{index:{uniq:function(e){if(!e.is_unique())throw"index of the setted object is not unique. the only allowed array index type is boolean[]."}}}};o.check=m;function w(e,t){var n=t+e;return n<0?0:n}function d(e,t){m.iloc.str.colon(e);var n=e.split(":"),i=n[0],r=n[1];i=i||"0",r=r||t.toString();var s=[parseFloat(i),parseFloat(r)],u=s[0],a=s[1];return m.iloc.str.parsed(u,a),u<0&&(u=w(u,t)),a<0&&(a=w(a,t)),u>=a?[]:u>=t?[]:(a=a>t?t:a,Array.from(Array(a-u).keys()).map(function(h){return h+u}))}function O(e,t){return t===void 0?d(":".concat(e),e):d("".concat(e,":").concat(t),t)}o.range=O;function P(e,t){switch(!0){case typeof e=="string":return d(e,t);case(f(e)&&e<0):return e+t;case A(e):return e.map(function(n){return n<0?n+t:n});default:return e}}o._trans_iloc=P});var M=k((exports,module)=>{Object.defineProperty(exports,"__esModule",{value:!0});exports.range=exports.Index=exports.DataFrame=exports.Series=void 0;var util_1=S();Object.defineProperty(exports,"range",{enumerable:!0,get:function(){return util_1.range}});function cp(e){return e.slice(0)}var Index=function(){function e(t,n){this.name=n||"",this.values=t}return Object.defineProperty(e.prototype,"values",{get:function(){return this._values},set:function(t){var n=this;this.__values=t,this._values=new Proxy(t,{set:function(i,r,s){if(r!=="length"){var u=parseFloat(r);util_1.check.index.set(u,n.shape,s),i[u]=s,n.remap(),n.shape=n._values.length}else i[r]=s;return!0}}),this.remap(),this.shape=this._values.length},enumerable:!1,configurable:!0}),e.prototype.p=function(){var t=Array.from(this.values.keys()).join("	"),n=this.values.join("	"),i=this.name?" "+this.name:"",r="Index (".concat(this.shape,")").concat(i);console.log(t+`
`+n+`
`+r)},e.prototype._add=function(t,n){if(!this.mp.has(t))this.mp.set(t,n);else{var i=this.mp.get(t);Array.isArray(i)?i.push(n):this.mp.set(t,[i,n])}},e.prototype.remap=function(){var t=this;this.mp=new Map,this.values.forEach(function(n,i){t._add(n,i)})},e.prototype.insert=function(t,n){this.__values.splice(t,0,n),this.remap(),this.shape+=1},e.prototype.cp=function(){return new e(cp(this.__values),this.name)},e.prototype.has=function(t){return this.mp.has(t)},e.prototype.unique=function(){return Array.from(this.mp.keys())},e.prototype.is_unique=function(){return this.mp.size===this.shape},e.prototype.check=function(t){if(!this.mp.has(t))throw"".concat(t," does not exist in index")},e.prototype.trans=function(t){var n=this;if(Array.isArray(t)){var i=[];return t.forEach(function(r){n.check(r);var s=n.trans(r);Array.isArray(s)?i.push.apply(i,s):i.push(s)}),i}else return this.check(t),this.mp.get(t)},e}();exports.Index=Index;function vec_loc(e,t,n){if(t.length===0)return[];if(n===void 0&&(n=(0,util_1.isArr)(e[0])?function(r){return cp(r)}:function(r){return r}),typeof t[0]=="number")return t.map(function(r){return util_1.check.iloc.num(r,e.length),n(e[r])});util_1.check.iloc.bool(t,e.length);var i=[];return t.forEach(function(r,s){r&&i.push(n(e[s]))}),i}function vec_loc2(e,t,n){if(n.length===0)return[[],[]];var i=[],r=[],s=(0,util_1.isArr)(e[0])?function(a){return cp(a)}:function(a){return a},u=(0,util_1.isArr)(t[0])?function(a){return cp(a)}:function(a){return a};return typeof n[0]=="number"?n.forEach(function(a){util_1.check.iloc.num(a,e.length),i.push(s(e[a])),r.push(u(t[a]))}):(util_1.check.iloc.bool(n,e.length),n.forEach(function(a,h){a&&(i.push(s(e[h])),r.push(u(t[h])))})),[i,r]}function vec_set(e,t,n){if(n.length===0){util_1.check.iset.rpl.num(t,n.length);return}var i=(0,util_1.isArr)(t[0])?function(s){return cp(s)}:function(s){return s};if(typeof n[0]=="number")util_1.check.iset.rpl.num(t,n.length),n.forEach(function(s,u){util_1.check.iloc.num(s,e.length),u===0&&((0,util_1.isArr)(e[0])?util_1.check.iset.rpl.num(t[0],e[0].length):util_1.check.iset.rpl.val(t[0])),e[s]=i(t[u])});else{var r=0;n=n,util_1.check.iloc.bool(n,e.length),util_1.check.iset.rpl.bool(t,n),n.forEach(function(s,u){s&&(r===0&&((0,util_1.isArr)(e[0])?util_1.check.iset.rpl.num(t[0],e[0].length):util_1.check.iset.rpl.val(t[0])),e[u]=i(t[r]),r+=1)})}}function _str(e){return(0,util_1.isNum)(e)||(0,util_1.isStr)(e)||(0,util_1.isArr)(e)?e.toString():JSON.stringify(e)}function _trans(e,t){switch(!0){case(0,util_1.isVal)(t):t=e.trans(t);break;case t instanceof Index:t=e.trans(t.values);break;case(t instanceof Series&&t.values.length>0&&typeof t.values[0]!="boolean"):t=e.trans(t.values);break;case t instanceof Series:t=t.values;break;case((0,util_1.isArr)(t)&&t.length>0&&typeof t[0]!="boolean"):t=e.trans(t);break}return t}var setIndex=function(e,t){var n=e instanceof Index?e.shape:e.length;return util_1.check.frame.index.set(t,n),e instanceof Index?e:new Index(e)},Series=function(){function Series(e,t,n){switch(this.values=e,this.shape=this.values.length,!0){case(t===void 0&&n===void 0):this.name="",this.index=new Index(this.values.map(function(i,r){return r}));break;case(n===void 0&&((0,util_1.isNum)(t)||(0,util_1.isStr)(t))):this.name=t,this.index=new Index(this.values.map(function(i,r){return r}));break;case n===void 0:this.name="",this.index=t instanceof Index?t:new Index(t);break;default:this.name=n,this.values=e,this.index=t instanceof Index?t:new Index(t)}}return Object.defineProperty(Series.prototype,"index",{get:function(){return this._index},set:function(e){this._index=setIndex(e,this.shape)},enumerable:!1,configurable:!0}),Series.prototype.p=function(){var e=this.name?" "+this.name:"";console.log(this.index.values.map(function(t){return t.toString()}).join("	")+`
`+this.values.map(function(t){return _str(t)}).join("	")+`
`+"Series (".concat(this.shape,")").concat(e))},Series.prototype._iloc=function(e){switch(!0){case e===void 0:return new Series(cp(this.values),this.index.cp(),this.name);case(0,util_1.isNum)(e):return util_1.check.iloc.num(e,this.shape),this.values[e];default:var t=vec_loc2(this.values,this.index.values,e),n=t[0],i=t[1],r=new Index(i,this.index.name);return new Series(n,i,this.name)}},Series.prototype.iloc=function(e){return e=(0,util_1._trans_iloc)(e,this.shape),this._iloc(e)},Series.prototype.loc=function(e){var t=_trans(this.index,e);return this._iloc(t)},Series.prototype._iset=function(e,t){switch(!0){case e===void 0:util_1.check.iset.rpl.num(t,this.shape),this.values=cp(t);break;case(0,util_1.isVal)(e):util_1.check.iloc.num(e,this.shape),this.values[e]=t;break;default:vec_set(this.values,t,e)}},Series.prototype.iset=function(e,t){t===void 0?this._iset(void 0,e):(e=(0,util_1._trans_iloc)(e,this.shape),this._iset(e,t))},Series.prototype.set=function(e,t){if(t===void 0)this._iset(void 0,e);else if((0,util_1.isVal)(e)&&!this.index.has(e))this.push(t,e);else{if((e instanceof Index||e instanceof Series)&&(e=e.values),(0,util_1.isNum)(e)||(0,util_1.isStr)(e)){var n=this.index.mp.get(e);(0,util_1.isArr)(n)&&!(0,util_1.isArr)(t)&&(t=Array.from(Array(n.length).keys()).map(function(r){return t}))}var i=_trans(this.index,e);this._iset(i,t)}},Series.prototype.push=function(e,t){t===void 0&&(t=""),this.values.push(e),this.index.values.push(t),this.shape+=1},Series.prototype.insert=function(e,t,n){n===void 0&&(n=""),util_1.check.iloc.num(e,this.shape),this.values.splice(e,0,t),this.index.insert(e,n),this.shape+=1},Series.prototype.drop=function(e){var t=this;e=(0,util_1.isArr)(e)?e:[e];var n=e,i=(0,util_1.range)(this.index.shape).filter(function(r){return!n.includes(t.index.values[r])});return this.iloc(i)},Series.prototype.b=function(expr){return this.values.map(function(x){return eval(expr)})},Series.prototype.q=function(e){var t=this.b(e);return this.loc(t)},Series}();exports.Series=Series;var DataFrame=function(){function DataFrame(e,t,n){if(e.length>0&&!(0,util_1.isArr)(e[0])){n=Object.keys(e[0]);var i=n;e=e.map(function(r){return i.map(function(s){return r[s]})}),t=t||null}e=e,n===void 0&&e.length===0&&(n=[]),n===void 0&&(n=e[0].map(function(r,s){return s})),t==null&&(t=e.map(function(r,s){return s})),this._index=t instanceof Index?t:new Index(t),this._columns=n instanceof Index?n:new Index(n),this.shape=[this.index.shape,this.columns.shape],util_1.check.frame.index.set(e.length,this.shape[0]),e.length>0&&util_1.check.frame.index.set(e[0].length,this.shape[1]),this.values=e,e.length>0?this.tr=this._transpose(e):(this.tr=Array.from(Array(this.shape[1]).keys()).map(function(r){return[]}),this.values=this._transpose(this.tr))}return DataFrame.prototype.__transpose=function(e){return e[0].map(function(t,n){return e.map(function(i){return i[n]})})},DataFrame.prototype._transpose=function(e){return e.length===0?[]:this.__transpose(e)},Object.defineProperty(DataFrame.prototype,"index",{get:function(){return this._index},set:function(e){this._index=setIndex(e,this.shape[0])},enumerable:!1,configurable:!0}),Object.defineProperty(DataFrame.prototype,"columns",{get:function(){return this._columns},set:function(e){this._columns=setIndex(e,this.shape[1])},enumerable:!1,configurable:!0}),DataFrame.prototype._p=function(){var e=this,t=[],n="".concat(this.index.name,"\\").concat(this.columns.name);t.push(n+"	"+this.columns.values.map(function(r){return r.toString()}).join("	"));var i=this.values.map(function(r,s){var u=[];return u.push(e.index.values[s].toString()),u=u.concat(r.map(function(a){return JSON.stringify(a)})),u.join("	")});t=t.concat(i),console.log(t.join(`
`)+`
DataFrame `+"(".concat(this.shape,")"))},DataFrame.prototype.p=function(){var e="".concat(this.index.name,"|").concat(this.columns.name),t=this.reset_index(e).reset_columns();console.table(t.values),console.log("DataFrame "+"(".concat(this.shape,")"))},DataFrame.prototype.transpose=function(e){var t,n,i;return e===void 0&&(e=!1),e?(t=[this.tr,this.values],this.values=t[0],this.tr=t[1],n=[this.shape[1],this.shape[0]],this.shape[0]=n[0],this.shape[1]=n[1],i=[this.columns,this.index],this.index=i[0],this.columns=i[1],this):new DataFrame(cp(this.tr),this.columns.cp(),this.index.cp())},DataFrame.prototype._iloc_asymmetric=function(e,t,n,i,r,s){switch(!0){case((0,util_1.isNum)(r)&&s===void 0):util_1.check.iloc.num(r,t.shape);var u=r;return new Series(cp(e[u]),n.cp(),t.values[u]);case((0,util_1.isNum)(r)&&(0,util_1.isArr)(s)):{util_1.check.iloc.num(r,t.shape);var a=s,h=r,c=e[h],y=vec_loc2(c,n.values,a),F=y[0],_=y[1],D=new Index(_,n.name);return new Series(F,D,t.values[h])}case((0,util_1.isArr)(r)&&s===void 0):{var I=r,g=vec_loc2(e,t.values,I),N=g[0],_=g[1],j=new Index(_,t.name),q=n.cp(),b=new DataFrame(N,j,q);return i?b.transpose(!0):b}default:return null}},DataFrame.prototype._iloc_symmetric=function(e,t){switch(!0){case(e==null&&t==null):var n=this.values.map(function(c){return cp(c)});return new DataFrame(n,this.index.cp(),this.columns.cp());case((0,util_1.isNum)(e)&&(0,util_1.isNum)(t)):return util_1.check.iloc.num(e,this.shape[0]),util_1.check.iloc.num(t,this.shape[1]),this.values[e][t];case((0,util_1.isArr)(e)&&(0,util_1.isArr)(t)):var i=e,r=t,s=vec_loc(this.values,i,function(c){return c}),u=s.map(function(c){return vec_loc(c,r)}),a=new Index(vec_loc(this.index.values,i),this.index.name),h=new Index(vec_loc(this.columns.values,r),this.columns.name);return new DataFrame(u,a,h);default:return null}},DataFrame.prototype.iloc=function(e,t){e===null&&(e=void 0),t===null&&(t=void 0),e=(0,util_1._trans_iloc)(e,this.shape[0]),t=(0,util_1._trans_iloc)(t,this.shape[1]);var n;if(n=this._iloc_symmetric(e,t),n!==null)return n;if(t===void 0||(0,util_1.isVal)(e)){if(n=this._iloc_asymmetric(this.values,this.index,this.columns,!1,e,t),n!==null)return n}else if(n=this._iloc_asymmetric(this.tr,this.columns,this.index,!0,t,e),n!==null)return n;throw"input parameters for iloc might be wrong"},DataFrame.prototype.loc=function(e,t){e===null&&(e=void 0),t===null&&(t=void 0),e=e,t=t;var n=_trans(this.index,e),i=_trans(this.columns,t);return this.iloc(n,i)},DataFrame.prototype._iset_asymmetric=function(e,t,n,i,r,s){switch(!0){case((0,util_1.isVal)(i)&&s===void 0):util_1.check.iloc.num(i,t.shape),util_1.check.iset.rpl.num(r,n.shape),e[i]=r;break;case((0,util_1.isVal)(i)&&(0,util_1.isArr)(s)):{util_1.check.iloc.num(i,t.shape),util_1.check.iset.rpl.num(r,s.length);var u=s,a=e[i];vec_set(a,r,u)}break;case((0,util_1.isArr)(i)&&s===void 0):vec_set(e,r,i);break;default:return null}},DataFrame.prototype._iset_symmetric=function(e,t,n){switch(!0){case(e==null&&t==null):util_1.check.iset.rpl.mat(n,this.shape),this.values=n,this.tr=this._transpose(this.values);break;case((0,util_1.isVal)(e)&&(0,util_1.isVal)(t)):util_1.check.iloc.num(e,this.shape[0]),util_1.check.iloc.num(t,this.shape[1]),this.values[e][t]=n,this.tr[t][e]=n;break;case((0,util_1.isArr)(e)&&(0,util_1.isArr)(t)):var i=vec_loc(this.values,e,function(r){return r});i.forEach(function(r,s){vec_set(r,n[s],t)}),this.tr=this._transpose(this.values);break;default:return null}},DataFrame.prototype._iset=function(e,t,n){var i;if(i=this._iset_symmetric(e,t,n),i===null&&(n=n,t===void 0||(0,util_1.isVal)(e)?(i=this._iset_asymmetric(this.values,this.index,this.columns,e,n,t),i===void 0&&(this.tr=this._transpose(this.values))):(n.length>0&&(0,util_1.isArr)(n[0])&&(n=this._transpose(n)),i=this._iset_asymmetric(this.tr,this.columns,this.index,t,n,e),i===void 0&&(this.values=this._transpose(this.tr)))),i===null)throw"function failed. Please check the input for _iset"},DataFrame.prototype.iset=function(e,t,n){t===void 0&&n===void 0?this._iset(void 0,void 0,e):n===void 0?(e===null&&(e=void 0),this._iset(e,void 0,t)):(e===null&&(e=void 0),t===null&&(t=void 0),this._iset(e,t,n))},DataFrame.prototype.set=function(e,t,n){if(t===void 0&&n===void 0)this._iset(void 0,void 0,e);else if(n===void 0)if(e===null&&(e=void 0),(0,util_1.isVal)(e)&&!this.index.has(e))this.push(t,e,0);else{var i=_trans(this.index,e);this._iset(i,void 0,t)}else if(e===null&&(e=void 0),t===null&&(t=void 0),e===void 0&&(0,util_1.isVal)(t)&&!this.columns.has(t))this.push(n,t,1);else{var i=_trans(this.index,e),r=_trans(this.columns,t);this._iset(i,r,n)}},DataFrame.prototype._insert=function(e,t,n,i,r){util_1.check.iloc.num(e,t.shape),n.splice(e,0,i),t.insert(e,r)},DataFrame.prototype.push=function(e,t,n){t===void 0&&(t=""),n===void 0&&(n=1),n===0?(util_1.check.iset.rpl.num(e,this.shape[1]),this.values.push(e),this.index.values.push(t),this.shape[n]+=1,this.tr.forEach(function(i,r){i.push(e[r])})):(util_1.check.iset.rpl.num(e,this.shape[0]),this.tr.push(e),this.columns.values.push(t),this.shape[n]+=1,this.values.forEach(function(i,r){i.push(e[r])}))},DataFrame.prototype.insert=function(e,t,n,i){n===void 0&&(n=""),i===void 0&&(i=1),i===0?(e=e<0?this.shape[0]+e:e,this._insert(e,this.index,this.values,t,n),this.shape[i]+=1,this.tr=this._transpose(this.values)):(e=e<0?this.shape[1]+e:e,this._insert(e,this.columns,this.tr,t,n),this.shape[i]+=1,this.values=this._transpose(this.tr))},DataFrame.prototype.drop=function(e,t){var n=this;t===void 0&&(t=1),e=(0,util_1.isArr)(e)?e:[e];var i=e;if(t===0){var r=(0,util_1.range)(this.index.shape).filter(function(s){return!i.includes(n.index.values[s])});return this.iloc(r)}else{var r=(0,util_1.range)(this.columns.shape).filter(function(u){return!i.includes(n.columns.values[u])});return this.iloc(null,r)}},DataFrame.prototype.reset_index=function(e){var t=new DataFrame(cp(this.values),null,this.columns.cp()),n=this.index.values;return e=e||this.index.name,t.insert(0,n,e,1),t},DataFrame.prototype.reset_columns=function(e){var t=new DataFrame(cp(this.values),this.index.cp()),n=this.columns.values;return e=e||this.columns.name,t.insert(0,n,e,0),t},DataFrame.prototype.to_dict=function(e){e===void 0&&(e=1);var t=e===1?this.values:this.tr,n=e===1?this.columns:this.index;return n.is_unique()||console.warn("The index is not unique. The output will only include the value of the last key among duplicated keys."),t.map(function(i){var r={};return n.values.forEach(function(s,u){r[s]=i[u]}),r})},DataFrame.prototype.b=function(expr,axis){axis===void 0&&(axis=1);var arr=[];(0,util_1.range)(expr.length).forEach(function(e){var t=expr[e];(t==="["||t==="]")&&arr.push(e)}),util_1.check.frame.b.expr(arr.length);var labels=[],expr2=expr;(0,util_1.range)(arr.length/2).forEach(function(e){var t=arr[e*2],n=arr[e*2+1],i=expr.slice(t,n+1),r=expr.slice(t+1,n),s=r.trim(),u=(s.match(/"/g)||[]).length,a=(s.match(/'/g)||[]).length,h=u>a?u:a;s.includes(",")&&(h===0||h>2)||(s!==r&&(expr2=expr.replaceAll(i,"[".concat(s,"]"))),s=s[0]==='"'||s[0]==="'"?s.slice(1,s.length-1):parseInt(s),labels.push(s))}),expr=expr2;var index=axis===1?this.columns:this.index,vals=axis===1?this.values:this.tr,num_idx=labels.map(function(e){var t=index.trans(e),n=(0,util_1.isArr)(t)?t[t.length-1]:t;return n});labels.forEach(function(e,t){var n=num_idx[t],i=(0,util_1.isNum)(e)?"[".concat(e,"]"):'["'.concat(e,'"]'),r="v[".concat(n,"]");expr=expr.replaceAll(i,r)});var bidx=vals.map(function(v){return eval(expr)});return bidx},DataFrame.prototype.q=function(e,t){var n=null,i=null;switch(!0){case(e!==null&&t===void 0):n=this.b(e,1);break;case(e!==null&&t===null):i=this.b(e,0);break;case e===null:n=this.b(t,1);break;default:n=this.b(t,1),i=this.b(e,0)}return this.loc(n,i)},DataFrame}();exports.DataFrame=DataFrame});return M();})();
